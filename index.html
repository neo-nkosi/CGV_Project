<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>My first three.js app</title>
    <link rel="stylesheet" type="text/css" href="styles.css">
</head>
<body>
<div id="level-select">
    <header>
        <h1>Welcome To</h1>
        <h2>ESCAPE THE SINGULARITY</h2>
    </header>
    <button id="level-1">Level 1</button>
    <button id="level-2">Level 2</button>
    <button id="level-3">Level 3</button>
    <div id="additional-buttons-container">
        <button id="controls-button">Controls</button>
        <button id="credits-button">Credits</button>
    </div>
</div>

<img id="blindness-overlay" src="textures/blindness-vingnette.png">
</img>

<!-- New div for start screen -->
<div id="start-screen">
    <header>
        <h1>Escape The Singularity</h1>
    </header>
    <button id="start-game-button">Start Game</button>
</div>


<div id="pause-screen">
    <p>Game Paused</p>
    <button id="resume-button">Continue</button>
    <button id="pause-exit-button">Exit to Main Menu</button>
</div>

<div id="portalSpawn-screen">
    <p>All coins collected! Find portal and escape!</p>
</div>

<div id="win-screen">
    <p>You survive to see another day</p>
    <button id="continue-button">Continue</button>
</div>

<div id="lose-screen">
    <p>You Died</p>
    <button id="retry-button">Retry</button>
    <button id="menu-button">Main Menu</button>
</div>

<!-- Intermediate screen content -->
<div id="intermediate-screen">
    <div id="level-objective">
        <h3>Objective:</h3>
        <p></p> <!-- Objective text will go here -->
    </div>
    <div id="level-modifiers">
        <h3>Modifiers:</h3>
        <p></p> <!-- Modifiers text will go here -->
    </div>
    <button id="intermediate-continue-button">Continue</button>
    <button id="back-button">Back</button>
</div>

<script type="module">
    const levelDetails = {
        '1': {
            objective: 'Collect 3 coins. When all coins are collected, run to the portal to escape.',
            modifiers: 'You begin with 20 health. There is 1 monster.',
        },
        '2': {
            objective: 'Collect 5 coins. When all coins are collected, run to the portal to escape.',
            modifiers: 'You begin with 10 health. There is 1 monster.',
        },
        // ... more levels
    };
    function showIntermediateScreen(level) {
        // Set a global variable with the selected level
        window.selectedLevel = level;

        // Fetch the level details
        const details = levelDetails[level];

        // Change the content based on the level
        document.querySelector('#level-objective p').textContent = details.objective;
        document.querySelector('#level-modifiers p').textContent = details.modifiers;


        // Hide the level select screen
        document.getElementById('level-select').style.display = 'none';

        // Show the intermediate screen
        document.getElementById('intermediate-screen').style.display = 'flex';

        // Back button event listener
        document.getElementById('back-button').addEventListener('click', function() {
            // Hide the intermediate screen
            document.getElementById('intermediate-screen').style.display = 'none';

            // Show the level select screen
            document.getElementById('level-select').style.display = 'flex';
        });
    }

    function loadMainScript() {
        // Import the main script
        import('/main.js')
            .catch((error) => {
                console.error("An error occurred while loading the script: ", error);
            });
    }


    // Level buttons event listeners
    document.getElementById('level-1').addEventListener('click', function() {
        showIntermediateScreen('1');
    });

    document.getElementById('level-2').addEventListener('click', function() {
        showIntermediateScreen('2');
    });

    document.getElementById('level-3').addEventListener('click', function() {
        showIntermediateScreen('3');
    });

    // Continue button event listener
    document.getElementById('intermediate-continue-button').addEventListener('click', function() {
        // Hide the intermediate screen
        document.getElementById('intermediate-screen').style.display = 'none';

        // Load the main script
        loadMainScript();
    });


    document.addEventListener('keydown', function(event) {
        if (event.code === 'KeyP') { // Let's say 'P' for 'Pause'
            window.pauseGame(); // this calls the pauseGame function from your main.js
            document.getElementById('pause-screen').style.display = 'flex'; // show the pause screen
        }
    });

    document.getElementById('resume-button').addEventListener('click', function() {
        document.getElementById('pause-screen').style.display = 'none'; // hide the pause screen
        window.resumeGame(); // this calls the resumeGame function from your main.js
    });

    document.getElementById('continue-button').addEventListener('click', function() {
        location.reload(); // This will force the page to reload
    });

    document.getElementById('menu-button').addEventListener('click', function() {
        location.reload(); // This will force the page to reload
    });

    document.getElementById('pause-exit-button').addEventListener('click', function() {
        location.reload(); // This will force the page to reload
    });

    document.addEventListener('DOMContentLoaded', (event) => {
        // Start game button event listener
        document.getElementById('start-game-button').addEventListener('click', function() {
            // Hide the start screen
            document.getElementById('start-screen').style.display = 'none';

            // Show the level select screen
            document.getElementById('level-select').style.display = 'flex';
        });
    });


</script>
</body>
</html>
